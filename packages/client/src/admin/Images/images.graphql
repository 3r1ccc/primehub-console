fragment ImageInfo on Image {
  id
  name
  displayName
  description
  type
  isReady
}

query ImagesQuery(
  $page: Int
  $where: ImageWhereInput
  $orderBy: ImageOrderByInput
) {
  imagesConnection(
    page: $page
    orderBy: $orderBy
    where: $where
    mode: SYSTEM_ONLY
  ) {
    edges {
      cursor
      node {
        id
        ...ImageInfo
      }
    }
    pageInfo {
      currentPage
      totalPage
    }
  }
}

query ImageQuery($where: ImageWhereUniqueInput!) {
  image(where: $where) {
    id
    url
    urlForGpu
    useImagePullSecret
    global
    groups {
      id
      name
      displayName
    }
    imageSpec {
      baseImage
      pullSecret
      packages {
        apt
        conda
        pip
      }
    }
    ...ImageInfo
  }
}

query SecretsQuery {
  secrets(where: { ifDockerConfigJson: true }) {
    id
    name
    type
  }
}

query BaseImagesQuery {
  images(mode: SYSTEM_ONLY) {
    id
    groupName
    useImagePullSecret
    url
    urlForGpu
    ...ImageInfo
  }
}

mutation CreateImageMutation($data: ImageCreateInput!) {
  createImage(data: $data) {
    id
  }
}

mutation UpdateImageMutation($data: ImageUpdateInput!, $where: ImageWhereUniqueInput!) {
  updateImage(data: $data, where: $where) {
    id
    useImagePullSecret
  }
}


mutation DeleteImageMutation($where: ImageWhereUniqueInput!) {
  deleteImage(where: $where) {
    id
  }
}
